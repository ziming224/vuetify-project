import{f as ie,g as re,p as oe,v as ce,b4 as se,c as V,s as Y,r as de,d as z,e as ve,y as F,w as fe,o as me,D as pe,au as Z,E as b,F as v,I as A,G as be,ai as j,U as q,aE as Ne,aA as ge,b6 as we,S as he,bT as Pe}from"./index-BnytfeGo.js";import{V as B}from"./VDivider-LPd1PCe4.js";const xe=50,Ve=500;function Ie(n){let{toggleUpDown:M}=n,l=-1,m=-1;ie(c);function I(a){c(),g(a),window.addEventListener("pointerup",c),document.addEventListener("blur",c),l=window.setTimeout(()=>{m=window.setInterval(()=>g(a),xe)},Ve)}function c(){window.clearTimeout(l),window.clearInterval(m),window.removeEventListener("pointerup",c),document.removeEventListener("blur",c)}function g(a){M(a==="up")}return{holdStart:I,holdStop:c}}const De=oe({controlVariant:{type:String,default:"default"},inset:Boolean,hideInput:Boolean,modelValue:{type:Number,default:null},min:{type:Number,default:Number.MIN_SAFE_INTEGER},max:{type:Number,default:Number.MAX_SAFE_INTEGER},step:{type:Number,default:1},precision:{type:Number,default:0},...ge(we(),["modelValue","validationValue"])},"VNumberInput"),Se=re()({name:"VNumberInput",props:{...De()},emits:{"update:focused":n=>!0,"update:modelValue":n=>!0},setup(n,M){let{slots:l}=M;const m=ce(),{holdStart:I,holdStop:c}=Ie({toggleUpDown:U}),g=se(n),a=V(()=>g.isDisabled.value||g.isReadonly.value),D=Y(n.focused);function w(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n.precision;const r=t==null?String(e):e.toFixed(t);return D.value?Number(r).toString():r}const u=de(n,"modelValue",null,e=>e??null,e=>e==null?e??null:z(Number(e),n.min,n.max)),h=Y(null);ve(()=>{D.value&&!a.value||(u.value==null?h.value=null:isNaN(u.value)||(h.value=w(u.value)))});const o=V({get:()=>h.value,set(e){e===null||e===""?(u.value=null,h.value=null):!isNaN(Number(e))&&Number(e)<=n.max&&Number(e)>=n.min&&(u.value=Number(e),h.value=e)}}),R=V(()=>a.value?!1:(u.value??0)+n.step<=n.max),L=V(()=>a.value?!1:(u.value??0)-n.step>=n.min),i=V(()=>n.hideInput?"stacked":n.controlVariant),$=F(()=>i.value==="split"?"$plus":"$collapse"),H=F(()=>i.value==="split"?"$minus":"$expand"),E=F(()=>i.value==="split"?"default":"small"),y=F(()=>i.value==="stacked"?"auto":"100%"),J={props:{onClick:S,onPointerup:f,onPointerdown:K,onPointercancel:f}},Q={props:{onClick:S,onPointerup:f,onPointerdown:O,onPointercancel:f}};fe(()=>n.precision,()=>ne()),me(()=>{_()});function G(e){if(e==null)return 0;const t=e.toString(),r=t.indexOf(".");return~r?t.length-r:0}function U(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(a.value)return;if(u.value==null){o.value=w(z(0,n.min,n.max));return}let t=Math.max(G(u.value),G(n.step));n.precision!=null&&(t=Math.max(t,n.precision)),e?R.value&&(o.value=w(u.value+n.step,t)):L.value&&(o.value=w(u.value-n.step,t))}function W(e){var k;if(!e.data)return;const t=e.target,{value:r,selectionStart:T,selectionEnd:C}=t??{},p=r?r.slice(0,T)+e.data+r.slice(C):e.data,N=Pe(p,n.precision);/^-?(\d+(\.\d*)?|(\.\d+)|\d*|\.)$/.test(p)||(e.preventDefault(),t.value=N),n.precision!=null&&(((k=p.split(".")[1])==null?void 0:k.length)>n.precision&&(e.preventDefault(),t.value=N),n.precision===0&&p.includes(".")&&(e.preventDefault(),t.value=N))}async function ee(e){["Enter","ArrowLeft","ArrowRight","Backspace","Delete","Tab"].includes(e.key)||e.ctrlKey||["ArrowDown","ArrowUp"].includes(e.key)&&(e.preventDefault(),_(),await he(),e.key==="ArrowDown"?U(!1):U())}function S(e){e.stopPropagation()}function f(e){const t=e.currentTarget;t==null||t.releasePointerCapture(e.pointerId),e.preventDefault(),c()}function K(e){const t=e.currentTarget;t==null||t.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),I("up")}function O(e){const t=e.currentTarget;t==null||t.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),I("down")}function _(){if(a.value||!m.value)return;const e=m.value.value;e&&!isNaN(Number(e))?o.value=w(z(Number(e),n.min,n.max)):o.value=null}function ne(){if(!a.value){if(u.value===null||isNaN(u.value)){o.value=null;return}o.value=n.precision==null?String(u.value):u.value.toFixed(n.precision)}}function te(){if(!a.value){if(u.value===null||isNaN(u.value)){o.value=null;return}o.value=u.value.toString()}}function ue(){te()}function le(){_()}return pe(()=>{const{modelValue:e,...t}=Z.filterProps(n);function r(){return l.increment?v(q,{key:"increment-defaults",defaults:{VBtn:{disabled:!R.value,flat:!0,height:y.value,size:E.value,icon:$.value}}},{default:()=>[l.increment(J)]}):v(j,{"aria-hidden":"true","data-testid":"increment",disabled:!R.value,flat:!0,height:y.value,icon:$.value,key:"increment-btn",onClick:S,onPointerdown:K,onPointerup:f,onPointercancel:f,size:E.value,tabindex:"-1"},null)}function T(){return l.decrement?v(q,{key:"decrement-defaults",defaults:{VBtn:{disabled:!L.value,flat:!0,height:y.value,size:E.value,icon:H.value}}},{default:()=>[l.decrement(Q)]}):v(j,{"aria-hidden":"true","data-testid":"decrement",disabled:!L.value,flat:!0,height:y.value,icon:H.value,key:"decrement-btn",onClick:S,onPointerdown:O,onPointerup:f,onPointercancel:f,size:E.value,tabindex:"-1"},null)}function C(){return b("div",{class:"v-number-input__control"},[T(),v(B,{vertical:i.value!=="stacked"},null),r()])}function p(){return!n.hideInput&&!n.inset?v(B,{vertical:!0},null):void 0}const N=i.value==="split"?b("div",{class:"v-number-input__control"},[v(B,{vertical:!0},null),r()]):n.reverse||i.value==="hidden"?void 0:b(A,null,[p(),C()]),k=l["append-inner"]||N,X=i.value==="split"?b("div",{class:"v-number-input__control"},[T(),v(B,{vertical:!0},null)]):n.reverse&&i.value!=="hidden"?b(A,null,[C(),p()]):void 0,ae=l["prepend-inner"]||X;return v(Z,be({ref:m},t,{modelValue:o.value,"onUpdate:modelValue":s=>o.value=s,focused:D.value,"onUpdate:focused":s=>D.value=s,validationValue:u.value,onBeforeinput:W,onFocus:ue,onBlur:le,onKeydown:ee,class:["v-number-input",{"v-number-input--default":i.value==="default","v-number-input--hide-input":n.hideInput,"v-number-input--inset":n.inset,"v-number-input--reverse":n.reverse,"v-number-input--split":i.value==="split","v-number-input--stacked":i.value==="stacked"},n.class],style:n.style,inputmode:"decimal"}),{...l,"append-inner":k?function(){var x;for(var s=arguments.length,P=new Array(s),d=0;d<s;d++)P[d]=arguments[d];return b(A,null,[(x=l["append-inner"])==null?void 0:x.call(l,...P),N])}:void 0,"prepend-inner":ae?function(){var x;for(var s=arguments.length,P=new Array(s),d=0;d<s;d++)P[d]=arguments[d];return b(A,null,[X,(x=l["prepend-inner"])==null?void 0:x.call(l,...P)])}:void 0})}),Ne({},m)}});export{Se as V};
